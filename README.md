# 📘 BLISS: Business Language Interface for Self-Serve SQL

A proof-of-concept (PoC) tool that lets business users ask questions in plain English and instantly get SQL queries — powered by an LLM and a lightweight rule engine.

---

## ✅ What This Does

- Translates natural language questions into SQL using:
  - 🤖 A local LLM (Mistral via Ollama)
  - 🧠 A rule-based SQL generator
- Provides context from:
  - ERD (YAML format)
  - Business glossary (CSV with table/column mapping + synonyms)
  - Optional schema metadata
- Displays matched business terms
- 📘 Exposes glossary in UI (inline and full view)
- Lets users compare LLM and rule-based SQL outputs

---

## 🧱 Architecture Overview

| Layer              | Status | Highlights |
|-------------------|--------|------------|
| Metadata Loader   | ✅     | Loads YAML + CSV metadata cleanly |
| LLM Prompt Adapter| ✅     | Structured prompt creation with glossary/ERD |
| Rule Engine       | ✅     | ERD-based keyword matching for basic SQL |
| Controller        | ✅     | Routes question through both engines |
| UI (Streamlit)    | ✅     | Clean UX with toggles, term highlighting |

---

## 🧩 Current Capabilities

- Ask business questions
- See SQL generated by:
  - LLM (via formatted prompt)
  - Rule engine (fallback logic)
- View matched business glossary terms
- Browse glossary as table
- Easily toggle advanced dev views

---

## 🛠️ Next Steps

### 🎯 Short-Term

| Area     | Goal |
|----------|------|
| Backend  | ✅ Execute SQL on local DB (e.g., SQLite, DuckDB) |
| Backend  | ✅ Add SQL validation & formatting (e.g., via sqlglot) |
| Frontend | ✅ Display tabular results from backend |
| Frontend | ✅ Show matched glossary terms in UI |
| Frontend | ✅ Add glossary toggle (full glossary + inline) |
| Frontend | 🔲 Add feedback loop (flag incorrect SQL) |

### 📊 Output Features (Coming Soon)

| Feature         | Benefit |
|----------------|---------|
| 📈 Visual Charts | Plot results for quick insights |
| 📁 CSV Download | Export results easily |
| 🧠 Term Tracing | Map glossary terms → SQL columns |

---

## 📁 File Structure

```
bliss-sanssql-poc/
│
├── backend/
│   ├── main.py            # FastAPI app
│   ├── controller.py      # Orchestrates LLM + rule engine
│   ├── llm_adapter.py     # Formats prompt, calls LLM
│   ├── rule_engine.py     # Basic SQL generation from ERD
│   ├── metadata_loader.py # Loads ERD, glossary, metadata
│
├── metadata/
│   ├── erd.yaml           # Tables, columns, joins
│   ├── glossary.csv       # Business terms → table.column
│   └── schema_metadata.yaml (optional)
│
├── frontend/
│   └── streamlit_app.py   # Streamlit UI
```

---

## 🚀 Getting Started

```bash
# 1. Start backend
cd backend
uvicorn main:app --reload

# 2. Run frontend
cd ../frontend
streamlit run streamlit_app.py
```

---

## 🙌 Credits & Notes

- Built by Ram with ChatGPT as a thinking and engineering partner 💬
- Mistral runs locally via Ollama for fast LLM inference
- Designed to be modular and beginner-friendly
- Best used as a template for more vertical-specific self-serve analytics tools

---

## ✅ Status: Working Prototype

This PoC is end-to-end functional for generating and interpreting SQL.
Next: execute SQL, visualize results, and enable export.


